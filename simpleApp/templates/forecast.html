<!DOCTYPE html>
<html>
<head>
    <title>Weather Search Results</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
</head>
<body>
    <div class="container">
        <div class="row mt-4">
            <div class="col text-center">
                <button id="get-weather" class="btn btn-primary">Get Weather</button>
                <a href="/weather_form/" class="btn btn-secondary">Search Weather</a>
            </div>
        </div>
    
        <div class="row mt-4">
            <div class="col">
                <h1 class="text-center">Current weather for {{ current.city }}</h1>
                <table class="table">
                    <tbody>
                        <tr>
                            <th scope="row">Current time</th>
                            <td>{{ current_time }}</td>
                        </tr>
                        <tr>
                            <th scope="row">Country</th>
                            <td>{{ current.country }}</td>
                        </tr>
                        <tr>
                            <th scope="row">Weather</th>
                            <td>{{ current.weather }}</td>
                        </tr>
                        <tr>
                            <th scope="row">Temperature</th>
                            <td>{{ current.temperature }}°C</td>
                        </tr>
                        <tr>
                            <th scope="row">Wind Speed</th>
                            <td>{{ current.wind_speed }} m/s</td>
                        </tr>
                        <tr>
                            <th scope="row">Humidity</th>
                            <td>{{ current.humidity }}%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="row mt-4">
            <div class="col">
                <h1 class="text-center">Weather forecast for {{ forecast.city.name }}</h1>
                {% for entry in forecast.list %}
                    <h2 class="text-center">Forecast #{{ forloop.counter }}</h2>
                    <table class="table">
                        <tbody>
                            <tr>
                                <th scope="row">Time</th>
                                <td>{{ entry.dt_txt }}</td>
                            </tr>
                            <tr>
                                <th scope="row">Weather</th>
                                <td>{{ entry.weather.0.description }}</td>
                            </tr>
                            <tr>
                                <th scope="row">Temperature</th>
                                <td>{{ entry.main.temp }}°C</td>
                            </tr>
                            <tr>
                                <th scope="row">Wind Speed</th>
                                <td>{{ entry.wind.speed }} m/s</td>
                            </tr>
                            <tr>
                                <th scope="row">Humidity</th>
                                <td>{{ entry.main.humidity }}%</p>
                            </tr>
                        </tbody>
                    </table>
                {% endfor %}
            </div>
        </div>
    </div>
    

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script>
        document.getElementById('get-weather').addEventListener('click', function() {
            if (!navigator.geolocation) {
                alert("Geolocation is not supported by your browser.");
            } else {
                navigator.geolocation.getCurrentPosition(success, error);
            }

            function success(position) {
                var lat = parseFloat(position.coords.latitude.toFixed(4));
                var lon = parseFloat(position.coords.longitude.toFixed(4));
                window.location.href = '/weather_search_by_coordinates/?lat=' + lat + '&lon=' + lon;
            }

            function error() {
                alert("Unable to retrieve your location.");
            }
        });
    </script>
</body>
</html>
